<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Anasayfa</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.0/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>
<style>
    body {
        font-size: medium;
        background-color: #f2f2f2;
    }

    a {
        text-align: center;
    }

    .centerDiv {
        padding: 0 30px;
        width: 1180px;
        margin: 0 auto;
        background-color: white;
        border: 2px solid #D3D3D3;
        border-radius: 8px;

    }

    .userList {
        padding: 0 30px;
        margin: 0 auto;
        background-color: white;
        border: 1px solid #D3D3D3;
        border-radius: 8px;

    }
    .forUserInfo{

        margin-top: 10px;
        margin-bottom: 10px;

    }
    .bs-example {
        margin: 20px;
    }

    .main {
        margin: 50px auto;
    }
    .form-control{
        height: 35px;
    }
    .has-search .form-control {
        padding-left: 2.375rem;
    }

    .has-search .form-control-feedback {
        position: absolute;
        z-index: 2;
        display: block;
        width: 2.375rem;
        height: 2.375rem;
        line-height: 2.375rem;
        text-align: center;
        pointer-events: none;
        color: #aaa;
    }

    .sidenav {
        margin-top: 3%;
        height: 100%;
        width: 160px;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 0;
        background-color: #353D42;
        overflow-x: hidden;
        padding-top: 20px;
    }

    .sidenav a {
        padding: 6px 8px 6px 16px;
        color: #818181;
        display: block;
        margin-top: 35%;
    }

    .sidenav a:hover {
        color: #f1f1f1;
    }

    @media screen and (max-height: 450px) {
        .sidenav {
            padding-top: 15px;
        }

        .sidenav a {
            font-size: 18px;
        }
    }

    @font-face {
        font-family: 'WebSymbolsRegular';
        font-weight: normal;
        font-style: normal;
    }

    .ca-menu {
        padding: 0;

    }

    .ca-menu li {
        overflow: hidden;
        position: relative;
        display: block;
        box-shadow: 1px 1px 2px rgba(0, 0, 0, 0.2);
        margin-bottom: 4px;
        transition: all 300ms linear;
    }

    .ca-menu li:last-child {
        margin-bottom: 0px;
    }

    .ca-menu li a {
        text-align: left;
        width: 100%;
        height: 50px;
        display: block;
        color: white;
    }

    .ca-content {
        position: absolute;
        height: 60px;
        top: 20px;
    }

    .ca-main {

        -webkit-transition: all 300ms linear;
        -moz-transition: all 300ms linear;
        -o-transition: all 300ms linear;
        -ms-transition: all 300ms linear;
        transition: all 300ms linear;
    }

    .ca-sub {
        font-size: 14px;
        color: #666;
        -webkit-transition: all 300ms linear;
        -moz-transition: all 300ms linear;
        -o-transition: all 300ms linear;
        -ms-transition: all 300ms linear;
        transition: all 300ms linear;
    }

    .ca-menu li:hover {
        background: #e1f0fa;
    }

    .ca-menu li:hover .ca-icon {
        font-size: 40px;
        color: #259add;
        opacity: 0.8;
        text-shadow: 0px 0px 13px #fff;
    }

    .ca-menu li:hover .ca-main {
        opacity: 1;
        color: #2676ac;
        -webkit-animation: moveFromTop 300ms ease-in-out;
        -moz-animation: moveFromTop 300ms ease-in-out;
        -ms-animation: moveFromTop 300ms ease-in-out;
    }

    .ca-menu li:hover .ca-sub {
        opacity: 1;
        -webkit-animation: moveFromBottom 300ms ease-in-out;
        -moz-animation: moveFromBottom 300ms ease-in-out;
        -ms-animation: moveFromBottom 300ms ease-in-out;
    }

    @-webkit-keyframes moveFromBottom {
        from {
            opacity: 0;
            -webkit-transform: translateY(200%);
        }
        to {
            opacity: 1;
            -webkit-transform: translateY(0%);
        }
    }

    @-moz-keyframes moveFromBottom {
        from {
            opacity: 0;
            -moz-transform: translateY(200%);
        }
        to {
            opacity: 1;
            -moz-transform: translateY(0%);
        }
    }

    @-ms-keyframes moveFromBottom {
        from {
            opacity: 0;
            -ms-transform: translateY(200%);
        }
        to {
            opacity: 1;
            -ms-transform: translateY(0%);
        }
    }

    @-webkit-keyframes moveFromTop {
        from {
            opacity: 0;
            -webkit-transform: translateY(-200%);
        }
        to {
            opacity: 1;
            -webkit-transform: translateY(0%);
        }
    }

    @-moz-keyframes moveFromTop {
        from {
            opacity: 0;
            -moz-transform: translateY(-200%);
        }
        to {
            opacity: 1;
            -moz-transform: translateY(0%);
        }
    }

    @-ms-keyframes moveFromTop {
        from {
            opacity: 0;
            -ms-transform: translateY(-200%);
        }
        to {
            opacity: 1;
            -ms-transform: translateY(0%);
        }
    }
    .forNameAndAut{
        padding: 0px;
    }

</style>
<body>
<div class="modal fade" id="editModal" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><b>EDIT</b></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div id="divBodyandButton">

            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="deleteModal" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button class="close" data-dismiss="modal" type="button">&times;</button>
                <h4 class="modal-title">DELETE</h4>
            </div>

            <div class="modal-body" id="deleteModalBody" style="font-size: 16pt;">
                <h1><b>Are You Sure ?</b></h1>
                <div class="row">
                    <div class="col-xs-12" id="userDeleteDiv" style="padding: 5px 15px 5px 15px;">
                    </div>
                    <div class="col-xs-0" id="userDeleteDiv1" style="padding: 5px 15px 5px 15px;">

                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button class="btn btn-danger" data-dismiss="modal" type="button">Kapat</button>
                <button class="btn btn-warning" data-dismiss="modal" type="button">Kapat</button>
            </div>
        </div>

    </div>
</div>

<div class="bodyDiv">
    <div class="row" id="forNavbar" style="margin:6%; margin-bottom: 0px;">
        <nav class="navbar navbar-expand-lg bg-dark navbar-dark fixed-top">
            <a class="navbar-brand" href="#"></a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="collapsibleNavbar">
                <ul class="navbar-nav">
                    <div>
                        <li class="nav-item" style="width: 100px">
                            <a class="nav-link" href="#" onclick=openUsersSet()>Kullanıcılar</a>
                        </li>
                    </div>
                    <div>
                        <li class="nav-item" style="width: 100px">
                            <a class="nav-link" href="#" onclick=openRolesSet()>Roller</a>
                        </li>
                    </div>
                    <div>
                        <li class="nav-item dropdown" style="width: 100px">
                            <a class="nav-link dropdown" href="#" onclick=openKeysSet()>Anahtarlar</a>

                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="#">Kartlar</a>
                                <a class="dropdown-item" href="#">Parmak İzi</a>
                                <a class="dropdown-item" href="#">Görüntüler 3</a>
                            </div>
                        </li>
                    </div>
                    <div>
                        <li class="nav-item" style="width: 100px">
                            <a class="nav-link" href="#" onclick=openSysSet()>Sistem</a>
                        </li>
                    </div>
                </ul>


            </div>
            <ul class="nav navbar-nav ">

                <li><a class="nav-link" href="#"><span class="glyphicon glyphicon-log-in"></span> Çıkış </a></li>
            </ul>
        </nav>
        <!--Finish navbar-->
    </div>
    <div class="row" id="userSetting" style="display: none">
        <div class="col-sm-12">
            <div class="container">
                <div class="col-sm-2"></div>
                <div class="col-sm-8 centerDiv">
                    <div class="main">
                        <div class="form-group has-search">
                            <span class="fa fa-search form-control-feedback"></span>
                            <input type="text" class="form-control" placeholder="Search">
                        </div>
                        <!-- Kullanıcı listeler-->

                        <div class="bs-example">
                            <nav>
                                <ul class="pagination justify-content-center">

                                    <li id="btnPrevPage" class="page-item disabled"><span class="page-link" onclick="previousPage()">Previous</span></li>

                                    <li  class="page-item active"><a href="#" class="page-link">1</a></li>
                                    <li class="page-item"><a href="#" class="page-link">2</a></li>
                                    <li class="page-item"><a href="#" class="page-link">3</a></li>
                                    <li class="page-item"><a href="#" class="page-link">4</a></li>
                                    <li class="page-item"><a href="#" class="page-link">5</a></li>

                                    <li id="btnNextPage" class="page-item"><a href="#" class="page-link" onclick="nextPage()">Next</a></li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                <div class="col-sm-2"></div>
            </div>
            <div class="container">
                <div class="col-sm-2"></div>
                <div class="col-sm-8 centerDiv2" style="padding: 0px">
                    <!--USER LİSTELEMEK İÇİN -->
                    <div id ="usersList" class="container usersList" style="width: 100%; padding: 0px;">
                        <!--<div class="container userList" >
                            <div class="col-sm-9 forUserInfo">
                                <div class="container forNameAndAut">
                                    <div class="col-sm-4">Ahmet Ali</div>
                                    <div class="col-sm-2" style="background-color: red;color: white;text-align: center">Admin</div>
                                    <div class="col-sm-6"></div>
                                </div>
                                <div class="container forInfo" style="font-size: 10px;font-style: italic">
                                    <div>152120121043</div>
                                    <div>+905052258986</div>
                                </div>
                                <div class="container keyInfo" >Kartı Yoktur</div>
                            </div>
                            <div class="col-sm-3 forButtons">
                                <div style="margin-top: 10px; margin-bottom: 5px;">
                                    <button type="button" class="btn btn-primary btn-lg">Düzenle</button>
                                    <button type="button" class="btn btn-primary btn-lg">Sil</button>
                                </div >
                                <div style="margin-top: 10px; margin-bottom: 5px;"><button type="button" class="btn btn-primary btn-lg">Anahtar Yönetimi</button></div>

                            </div>
                        </div>
                        <div class="container userList">
                            <div class="col-sm-9 forUserInfo">
                                <div class="container forNameAndAut">
                                    <div class="col-sm-4">Ahmet Ali</div>
                                    <div class="col-sm-2" style="background-color: red;color: white;text-align: center">Admin</div>
                                    <div class="col-sm-6"></div>
                                </div>
                                <div class="container forInfo" style="font-size: 10px;font-style: italic">
                                    <div>152120121043</div>
                                    <div>+905052258986</div>
                                </div>
                                <div class="container keyInfo" >Kartı Yoktur</div>
                            </div>
                            <div class="col-sm-3 forButtons">
                                <div style="margin-top: 10px; margin-bottom: 5px;">
                                    <button type="button" class="btn btn-primary btn-lg">Düzenle</button>
                                    <button type="button" class="btn btn-primary btn-lg">Sil</button>
                                </div >
                                <div style="margin-top: 10px; margin-bottom: 5px;"><button type="button" class="btn btn-primary btn-lg">Anahtar Yönetimi</button></div>

                            </div>
                        </div>
-->
                    </div>
                </div>
                <div class="col-sm-2"></div>
            </div>
        </div>
    </div>
    <div class="row" id="roleSetting" style="display: none">
        <div class="col-sm-2"></div>
        <div class="col-sm-8 centerDiv">
            <h1>SEHER</h1>
        </div>
        <div class="col-sm-2"></div>
    </div>
    <div class="row" id="keySetting" style="display: none">
        <div class="col-sm-12">
            <div class="container">
                <div class="col-sm-2"></div>
                <div class="col-sm-8 centerDiv">
                    <div class="main">
                        <div class="form-group has-search">
                            <span class="fa fa-search form-control-feedback"></span>
                            <input id="inputSearch" type="text" class="form-control" placeholder="Search">
                        </div>
                    </div>
                </div>
                <div class="col-sm-2"></div>
            </div>
            <div class="container">
                <div class="col-sm-2"></div>
                <div class="col-sm-8 centerDiv">
                    <!--USER LİSTELEMEK İÇİN -->
                </div>
                <div class="col-sm-2"></div>
            </div>
        </div>
    </div>
    <div class="row" id="systemSetting" style="display: none">
        <div class="col-sm-2"></div>
        <div class="col-sm-8 centerDiv">
            <div class="sidenav">
                <div class="content">
                    <ul class="ca-menu">
                        <li>
                            <a href="#">
                                <div class="ca-content">
                                    <h2 class="ca-main">Sistem Bakım-Onarım Modu</h2>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a href="#">
                                <div class="ca-content">
                                    <h2 class="ca-main">Sistem Başlangıç Ayar Modu</h2>
                                </div>
                            </a>
                        </li>
                    </ul>
                </div><!-- content -->
            </div>
            <!-- <div id="systemRepairMode">

                 &lt;!&ndash;modal gelecek&ndash;&gt;
             </div>
             <div id="systemRecoveryMode">

                 &lt;!&ndash;modal gelecek&ndash;&gt;
             </div>-->
        </div>
        <div class="col-sm-2"></div>
    </div>
</div>
<script>
    var name = "";
    var str="";
    var totalPages;
    var currentPage;

    var currentList = [];
    function getPage(page, name) {
        console.log("getPage:" + page);
        console.log("getPage:" + name);
        var api = "http://localhost:8080/admin/listeAPI?pageNo=" + page;
        if (name != null) {
            api += "&name=" + name;
        }
        $.ajax({
            url: api,
            contentType: 'application/json',
            traditional: true,
            dataType: 'json',
            processData: false,
            type: 'POST',
            success: function (data) {
                var status = data.status;
                str = data.data;
                if (data.successful == true) {
                    currentPage = str;
                    if (currentPage.isFirst) {
                        $("#btnPrevPage").prop("disabled", "disabled");
                    }
                    else {
                        $("#btnPrevPage").prop("disabled", "");
                    }
                    if (currentPage.isLast) {
                        $("#btnNextPage").prop("disabled", "disabled");
                    }
                    else {
                        $("#btnNextPage").prop("disabled", "");
                    }
                    console.log(str);
                    currentList = str.list;
                    listing(str);
                    if (status == 0) {
                        console.log("device control succeeded");
                    }
                }
            },
            error: function (data) {
                console.log("Device control failed" + data);
            }

        })

    }
    function listing(str) {
        var myObject = str.list;
        var mainContainer = document.getElementById('usersList');
        var tempDiv = "";
        var currentQuery = inputSearch.value;



        for (var i in myObject) {
            var user = myObject[i];
            var name = user.name;
            var surname=user.surname;
            var role = user.roles[0].role;
            var tc = user.tc;
            var email = user.email;
            var temp = "";

            if (currentQuery != "" && (!name.includes(currentQuery) && !lastName.includes(currentQuery))) {

                continue;
            }

            temp += '<div class="container userList" >';
            temp += '<div class="col-sm-8 forUserInfo">';
            temp += '<div class="container forNameAndAut">';
            temp += '<div class="col-sm-4">' + name +' '+surname+'</div>';
            temp += '<div class="col-sm-2" style="background-color: red;color: white;text-align: center">' + role + '</div>';
            temp += '<div class="col-sm-6"></div> </div>';
            temp += '<div class="container forInfo" style="font-size: 10px;font-style: italic">';
            temp += '<div>'+tc+'</div>'; //T.C. gelecek
            temp += '<div>'+email+'</div></div> ';   //Tel No gelecel
            temp += '<div class="container keyInfo" >Kartı Yoktur</div> </div>';
            temp += '<div class="col-sm-4 forButtons">';
            temp += '<div style="margin-top: 10px; margin-bottom: 5px;">';
            temp += '<button type="button" class="btn btn-primary btn-lg" style="margin-right: 5px; width: 70px;" onclick="editingModal(' + user.id + ')">Düzenle</button>';
            temp += '<button type="button" class="btn btn-primary btn-lg" style="width: 70px;"  onclick="deleteModal('+ user.id + ')" >Sil</button> </div >';
            temp += '<div style="margin-top: 10px; margin-bottom: 5px;"><button type="button" class="btn btn-primary btn-lg" style="width: 145px;">Anahtar Yönetimi</button></div> </div> </div>';

            tempDiv += temp;
        }
        usersList.innerHTML = tempDiv;
    }

        $(document).ready(function () {
        // $("#fixed-form-container .body").hide();
        getPage(0);

    })

    function editingModal(id) {

        var divBodyandButton = document.getElementById("divBodyandButton");
        var temModal ="" ;
        temModal+="<div>Heeeey</div>"
      /*  var tempModal = "";
        for (var i in currentList) {
            var user = currentList[i];
            var temp = "";
            if (user.id == id) {
                temp +='<div class="modal-body" id="editModalBody">';
                temp += '<input class="form-control" id="nameEdit" placeholder="Name" type="text" value="' + user.name + '"/>';
                temp += '<input class="form-control" id="lastNameEdit" placeholder="Surname" type="text" value="' + user.surname + '"/>';
                temp += '<input class="form-control" id="emailEdit" placeholder="E-Mail" type="text" value="' + user.email + '"/>';
                temp += '<input class="form-control" id="passwordEdit" placeholder="Password"/>';
                temp += '<input class="form-control" id="passwordEdit2" placeholder="Password Verify" />';
                temp += '<input class="form-control" id="Role" placeholder="Role" type="text" value="' + user.roles[0].role + '"/>';
                temp += '</div>';
                temp +='<div class="modal-footer">';
                temp +='<button type="button" id="editSave" onclick="editSave('+user.id+');" class="btn btn-primary">Save changes</button>';
                temp +='<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>';
                temp +='</div>';
                tempModal += temp;
            }
        }*/

        divBodyandButton.innerHTML = temModal;

        /*$("#editModal").modal().show();*/
        $("#editModal").modal('show');

    }

    function editSave(id) {
        var user=[];
        var name = nameEdit.value;
        var lastName = lastNameEdit.value;
        var email = emailEdit.value;
        var password = passwordEdit.value;
        var phone = editPhone.value;

        $(".error").hide();
        var hasError = false;
        var errorType = "";
        var checkVal = $("#passwordEdit2").val();
        // if (passwordVal.length < 8 || passwordVal.length < 8) {
        //     $("#password").after('<span class="error">Lütfen paralonızı 8 karakterdem fazla girin.</span>');
        //     hasError = true;
        // }
        if (password != checkVal) {
            $("#passwordEdit2").after('<span class="error">Parolanız eşleşmedi.</span>');
            hasError = true;
        }
        user ={
            id:id,
            name:name,
            lastName:lastName,
            email:email,
            password:password,
            phone:phone
        };
        $.ajax({
            url: "http://localhost:8080/guncelleAPI",
            contentType: 'application/json',
            traditional: true,
            data:JSON.stringify(user),
            dataType: 'json',
            processData: false,
            type: 'POST',
            success: function (data) {
                var status = data.status;
                str = data.Objectdata;
                if(data.successful ==true){
                    $('#editModal').modal('toggle');
                    $("#fixed-form-container .body").show();
                    $(".popupCon").fadeToggle(3000);
                    console.log("Kapatıldı");

                    console.log(str);
                }
            },
            error: function (data) {
                console.log("Device control failed" + data);
            }
        })
    }
    function deleteModal(id) {
        var deleteModal = document.getElementById("deleteModal");
    }


    function openUsersSet() {
        var x = document.getElementById("userSetting");
        if (x.style.display === "none") {
            x.style.display = "block";
            document.getElementById('roleSetting').style.display = "none";
            document.getElementById('keySetting').style.display = "none";
            document.getElementById('systemSetting').style.display = "none";
        } else {
            document.getElementById('roleSetting').style.display = "none";
            document.getElementById('keySetting').style.display = "none";
            document.getElementById('systemSetting').style.display = "none";
        }
    }

    function openRolesSet() {
        var x = document.getElementById("roleSetting");
        if (x.style.display === "none") {
            x.style.display = "block";
            document.getElementById('userSetting').style.display = "none";
            document.getElementById('keySetting').style.display = "none";
            document.getElementById('systemSetting').style.display = "none";
        } else {
            document.getElementById('userSetting').style.display = "none";
            document.getElementById('keySetting').style.display = "none";
            document.getElementById('systemSetting').style.display = "none";
        }
    }

    function openKeysSet() {
        var x = document.getElementById("keySetting");
        if (x.style.display === "none") {
            x.style.display = "block";
            document.getElementById('roleSetting').style.display = "none";
            document.getElementById('userSetting').style.display = "none";
            document.getElementById('systemSetting').style.display = "none";

        } else {
            document.getElementById('roleSetting').style.display = "none";
            document.getElementById('userSetting').style.display = "none";
            document.getElementById('systemSetting').style.display = "none";
        }

    }

    function openSysSet() {
        var x = document.getElementById("systemSetting");
        if (x.style.display === "none") {
            x.style.display = "block";
            document.getElementById('roleSetting').style.display = "none";
            document.getElementById('keySetting').style.display = "none";
            document.getElementById('userSetting').style.display = "none";
        } else {
            document.getElementById('roleSetting').style.display = "none";
            document.getElementById('keySetting').style.display = "none";
            document.getElementById('userSetting').style.display = "none";
        }
    }

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-7243260-2']);
    _gaq.push(['_trackPageview']);

    (function () {
        var ga = document.createElement('script');
        ga.type = 'text/javascript';
        ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0];
        s.parentNode.insertBefore(ga, s);
    });

</script>
</body>
</html>